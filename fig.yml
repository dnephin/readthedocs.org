#
#
#

webapp:
    build: .
    environment:
        DJANGO_SETTINGS_MODULE: 'webapp_settings'
    volumes_from:
        - configs
    volumes:
        - './user_builds:/rtd/user_builds'
    ports:
        - 8080:8000
    links:
        - database
        - redis
        - search

configs:
    build: dev/configs

database:
    build: factory/dist/database

redis:
    image: redis:latest

builder:
    build: dev/builder
    environment:
        DJANGO_SETTINGS_MODULE: 'webapp_settings'
    volumes_from:
        - configs
    volumes:
        - './user_builds:/rtd/user_builds'
    links:
        - redis
        - webapp
        - database # see github.com/rtfd/readthedocs.org/issues/987

# TODO: index fixture projects already in db
search:
    build: dev/search
    ports: 
        - 8081:9200

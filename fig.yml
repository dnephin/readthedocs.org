#
#
#

# TODO: needs to share volumes with celery for built docs or use nginx
webapp:
    build: .
    environment:
        DJANGO_SETTINGS_MODULE: 'webapp_settings'
    volumes_from:
        - configs
    ports:
        - 8080:8000
    links:
        - database
        - redis
        - search

configs:
    # TODO: rename since it's not just for webapp anymore
    build: dev/webapp_config

database:
    build: dev/database

redis:
    image: redis:latest

# TODO: run a separate api instance?
celery:
    build: dev/celery
    environment:
        DJANGO_SETTINGS_MODULE: 'webapp_settings'
    volumes_from:
        - configs
    links:
        - redis
        - webapp

# TODO: index fixture projects already in db
search:
    build: dev/search


#
# Misc
#
dockerui:
    build: github.com/crosbymichael/dockerui
    ports:
        - 8999:9000
    volumes:
        - '/var/run/:/var/run'
